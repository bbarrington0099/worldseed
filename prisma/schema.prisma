// WorldSeed Prisma Schema
// Full data model for D&D world management application

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ============================================================================
// USER & AUTHENTICATION (Auth.js Compatible)
// ============================================================================

/**
 * enum UserRole {
 * ADMIN
 * ARCHITECT
 * DESIGNER
 * DRAFTER
 * }
 */

model UserRole {
  id                               String @id @unique @default(cuid())
  name                             String @unique
  users                            User[]
  // Limits; set to -1 for unlimited
  worldOwnedLimit                  Int     // number of worlds a user can own
  worldForgerLimit                 Int     // number of worlds a user can forge not including their owned worlds (i.e., contribute to)
  contentPillarsPerWorldLimit      Int     // e.g., races, classes, continents, pantheons, guilds, etc.
  contentStructuresPerPillarLimit  Int     // e.g., towns, factions, landmarks, deities, quests, creature types, etc.
  contentElementsPerStructureLimit Int     // e.g., shops, legendary creatures, family trees, historical events, etc.
  contentItemsPerWorldLimit        Int     // e.g., shop items, characters, etc.
}

model User {
  id                 String    @id @unique @default(cuid())
  name               String?
  email              String    @unique
  emailVerified      DateTime?
  image              String?
  passwordHash       String
  roleId             String
  role               UserRole  @relation(fields: [roleId], references: [id])
  mustChangePassword Boolean   @default(true)
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  // Auth.js relations
  accounts Account[]
  sessions Session[]
  apiKeys  ApiKey[]

  // App relations
  masterOfGuilds Guild[]     @relation("GuildMasters")
  memberOfGuilds Guild[]     @relation("GuildMembers")
  characters     Character[]

  ownedWorlds    World[]
  forgedWorlds   World[] @relation("WorldForgers")
  occupiedWorlds World[] @relation("WorldOccupants")
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String? @db.Text
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model ApiKey {
  id        String   @id @unique @default(cuid())
  key       String   @unique
  createdAt DateTime @default(now())
  revoked   Boolean  @default(false)

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  worldId String
  world   World  @relation(fields: [worldId], references: [id], onDelete: Cascade)
}

// ============================================================================
// WORLD & GEOGRAPHY
// ============================================================================

model World {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String  @unique
  description          String  @db.Text
  measurementUnit      String  @default("miles")
  circumference        Int?
  diameter             Int?
  surfaceAreaSq        BigInt?
  currentDate          String?
  yearCalled           String  @default("years")
  additionalProperties Json?

  historicalPeriods HistoricalPeriod[]
  historyEvents     HistoricalEvent[]
  continents        Continent[]
  kingdoms          Kingdom[]

  connectedWorlds    World[]             @relation("ConnectedWorlds")
  connectedToWorlds  World[]             @relation("ConnectedWorlds")
  races              Race[]
  subraces           Subrace[]
  classes            Class[]
  subclasses         Subclass[]
  pantheons          Pantheon[]
  deities            Deity[]
  guilds             Guild[]
  characters         Character[]
  creatureTypes      CreatureType[]
  legendaryCreatures LegendaryCreature[]
  factions           Faction[]
  seasons            Season[]
  months             Month[]
  weekDays           WeekDay[]
  familyTrees        FamilyTree[]

  ownerId              String
  owner                User     @relation(fields: [ownerId], references: [id])
  apiKeys              ApiKey[]
  forgersCanSeedFrom   Boolean  @default(true) // allows forgers to use data from this world when seeding their own worlds
  forgersCanSeedTo     Boolean  @default(true) // allows forgers to seed this world using data from their own worlds
  forgers              User[]   @relation("WorldForgers")
  occupantsCanSeedFrom Boolean  @default(false)
  occupants            User[]   @relation("WorldOccupants")
}

model Continent {
  id                String  @id @default(uuid())
  seeded            Boolean @default(false)
  name              String  @unique
  description       String  @db.Text
  widthMi           Int?
  heightMi          Int?
  surfaceAreaSqMi   BigInt?
  languageReasoning String? @db.Text

  // Flag/Colors
  primaryColor    String?
  secondaryColor  String?
  flagSymbol      String?
  flagDescription String? @db.Text
  mapImagePath    String?
  flagImagePath   String?

  // Politics
  governmentType      GovernmentType
  politicalStructure  String?        @db.Text
  majorPoliticalIssue String?        @db.Text
  foreignRelations    String?        @db.Text

  additionalProperties Json?

  // Relations
  worldId   String
  world     World    @relation(fields: [worldId], references: [id])
  kingdomId String?
  kingdom   Kingdom? @relation(fields: [kingdomId], references: [id])

  capitalTownId String? @unique
  capitalTown   Town?   @relation("ContinentCapital", fields: [capitalTownId], references: [id])

  capitalOfKingdom Kingdom? @relation("KingdomCapital")

  towns              Town[]             @relation("PartOfContient")
  regions            Region[]
  stateInPeriods     ContinentHistory[]
  primaryLanguages   Language[]         @relation("PrimaryLanguages")
  secondaryLanguages Language[]         @relation("SecondaryLanguages")
  rareLanguages      Language[]         @relation("RareLanguages")

  voyagesFrom   Voyage[]      @relation("FromContinent")
  voyagesTo     Voyage[]      @relation("ToContinent")
  warsConflicts WarConflict[]
  treaties      Treaty[]
  tradeRoutes   TradeRoute[]

  raceLocations          RaceContinent[]
  subraceLocations       SubraceContinent[]
  subclassLocations      SubclassContinent[]
  guilds                 Guild[]
  creatureTypes          ContinentCreatureType[]
  legendaryCreatures     LegendaryCreature[]
  deityRecommendations   DeityRecommendation[]
  historicalEvents       HistoricalEvent[]
  professionRestrictions ProfessionContinentRestriction[]
  factionPresence        FactionContinentPresence[]
  ruler                  CharacterContinentRuler?
  charactersFrom         Character[]
  landmarks              Landmark[]
  quests                 Quest[]
}

model Landmark {
  id           String  @id @default(uuid())
  seeded       Boolean @default(false)
  name         String  @unique
  description  String  @db.Text
  location     String?
  significance String? @db.Text

  additionalProperties Json?

  continentId String
  continent   Continent @relation(fields: [continentId], references: [id])
}

enum ContinentLanguagePrevalence {
  PRIMARY
  SECONDARY
  RARE
}

model Kingdom {
  id              String  @id @default(uuid())
  seeded          Boolean @default(false)
  name            String  @unique
  description     String? @db.Text
  surfaceAreaSqMi BigInt?
  primaryColor    String?
  secondaryColor  String?
  flagSymbol      String?
  flagDescription String? @db.Text

  additionalProperties Json?

  dateFounded   String?
  dateDissolved String?

  governmentType      GovernmentType
  politicalStructure  String?        @db.Text
  majorPoliticalIssue String?        @db.Text
  foreignRelations    String?        @db.Text

  worldId String
  world   World  @relation(fields: [worldId], references: [id])

  continents Continent[]
  regions    Region[]

  capitalContinentId String?    @unique
  capitalContinent   Continent? @relation("KingdomCapital", fields: [capitalContinentId], references: [id])

  ruler CharacterKingdomRuler?
}

enum TownType {
  RUINS
  OUTPOST
  HAMLET
  VILLAGE
  TOWN
  CITY
  METROPOLIS
  CAPITAL
}

model Town {
  id          String   @id @default(uuid())
  seeded      Boolean  @default(false)
  name        String
  description String   @db.Text
  location    String?
  population  Int?
  type        TownType @default(VILLAGE)

  additionalProperties Json?

  continentId String
  continent   Continent @relation("PartOfContient", fields: [continentId], references: [id])

  capitalOfContinent Continent? @relation("ContinentCapital")

  regions                Region[]                    @relation("RegionTowns")
  guildHalls             GuildHall[]
  professionRestrictions ProfessionTownRestriction[]
  factionBases           FactionBase[]
  characterJobs          CharacterTownJob[]
  factionRelationships   FactionTownRelationship[]
  graveyard              Graveyard?
  tripsFrom              Road[]                      @relation("FromTown")
  tripsTo                Road[]                      @relation("ToTown")
  tradeRoutes            TradeRoute[]
  shops                  Shop[]
  charactersFrom         Character[]                 @relation("homeTown")
  charactersLivingIn     Character[]                 @relation("LivesInTown")
  quests                 Quest[]
}

model ShopItem {
  id                String  @id @default(uuid())
  seeded            Boolean @default(false)
  name              String
  description       String? @db.Text
  price             Int?
  currency          String?
  change            Int?
  changeCurrency    String?
  quantityAvailable Int?

  additionalProperties Json?

  shops Shop[]
}

model Shop {
  id          String     @id @default(uuid())
  seeded      Boolean    @default(false)
  name        String
  description String?    @db.Text
  type        String?
  inventory   ShopItem[]

  additionalProperties Json?

  townId  String?
  town    Town?              @relation(fields: [townId], references: [id], onDelete: Cascade)
  workers CharacterTownJob[]
}

model Region {
  id                   String               @id @default(uuid())
  seeded               Boolean              @default(false)
  name                 String               @unique
  description          String?              @db.Text
  createdAt            DateTime             @default(now())
  updatedAt            DateTime             @updatedAt
  kingdomId            String?
  kingdom              Kingdom?             @relation(fields: [kingdomId], references: [id])
  continentId          String
  continent            Continent            @relation(fields: [continentId], references: [id])
  creatureTypes        RegionCreatureType[]
  towns                Town[]               @relation("RegionTowns")
  additionalProperties Json?
}

model Voyage {
  id          String  @id @default(uuid())
  seeded      Boolean @default(false)
  name        String  @unique
  distanceMi  Int?
  travelDays  Int?
  travelHours Float?

  additionalProperties Json?

  tradeRoutes     TradeRoute[]
  fromContinentId String
  fromContinent   Continent    @relation("FromContinent", fields: [fromContinentId], references: [id])
  toContinentId   String
  toContinent     Continent    @relation("ToContinent", fields: [toContinentId], references: [id])

  @@unique([fromContinentId, toContinentId])
}

model Road {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  distanceMi           Int?
  travelDays           Int?
  travelHours          Int?
  travelMinutes        Int?
  additionalProperties Json?

  tradeRoutes TradeRoute[]
  fromTownId  String
  fromTown    Town         @relation("FromTown", fields: [fromTownId], references: [id], onDelete: Cascade)
  toTownId    String
  toTown      Town         @relation("ToTown", fields: [toTownId], references: [id], onDelete: Cascade)

  @@unique([fromTownId, toTownId])
}

enum GovernmentType {
  MONARCHY
  REPUBLIC
  DEMOCRACY
  THEOCRACY
  TRIBAL
  DICTATORSHIP
  OLIGARCHY
  ANARCHY
  EMPIRE
  CONCLAVE
}

enum WarConflictStatus {
  RESOLVED
  COLD_WAR
  LOW_INTENSITY
  HIGH_INTENSITY
}

model WarConflict {
  id                   String            @id @default(uuid())
  seeded               Boolean           @default(false)
  name                 String
  description          String?           @db.Text
  startDate            String?
  endDate              String?
  outcome              String?           @db.Text
  status               WarConflictStatus
  additionalProperties Json?

  continentsInvolved Continent[]
}

model Treaty {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  signedDate           String?
  terms                String? @db.Text
  additionalProperties Json?

  continentsInvolved Continent[]
}

enum TradeRouteType {
  OVERLAND
  UNDERGROUND
  MARITIME
  UNDERWATER
  AERIAL
  OVERLAND_TO_MARITIME
  UNDERGROUND_TO_MARITIME
  INTERWORLD
}

enum TradeRouteFrequency {
  DAILY
  WEEKLY
  BI_WEEKLY
  MONTHLY
  YEARLY
  IRREGULAR
}

model TradeRoute {
  id                   String              @id @default(uuid())
  seeded               Boolean             @default(false)
  name                 String
  description          String?             @db.Text
  goods                String[]
  routeType            TradeRouteType
  frequency            TradeRouteFrequency
  additionalProperties Json?

  continentStops Continent[]
  voyages        Voyage[]
  townStops      Town[]
  roads          Road[]
}

// ============================================================================
// WORLD HISTORY & TIMELINE
// ============================================================================

model HistoricalPeriod {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String  @unique
  startCycle           Int
  endCycle             Int?
  description          String  @db.Text
  significance         String? @db.Text
  sortOrder            Int     @default(0)
  additionalProperties Json?

  worldId String
  world   World  @relation(fields: [worldId], references: [id])

  deitysDuringPeriod     DeityHistory[]
  continentsDuringPeriod ContinentHistory[]
  events                 HistoricalEvent[]

  @@unique([worldId, sortOrder])
}

model ContinentHistory {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  description          String? @db.Text
  date                 String?
  additionalProperties Json?

  continentId String
  continent   Continent @relation(fields: [continentId], references: [id], onDelete: Cascade)

  periodId String
  period   HistoricalPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)

  @@unique([continentId, periodId])
}

model HistoricalEvent {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  date                 String?
  additionalProperties Json?
  description          String  @db.Text
  impact               String? @db.Text
  sortOrder            Int     @unique

  worldId     String?
  world       World?            @relation(fields: [worldId], references: [id])
  periodId    String?
  period      HistoricalPeriod? @relation(fields: [periodId], references: [id])
  continentId String?
  continent   Continent?        @relation(fields: [continentId], references: [id])
}

// ============================================================================
// RACES & CLASSES
// ============================================================================

model Race {
  id           String  @id @default(uuid())
  seeded       Boolean @default(false)
  name         String  @unique
  description  String  @db.Text
  ageAdulthood Int // 0 created/spawned as adult
  ageLifespan  Int // 0 for indefinite, - for up to that many years with immortal potential

  heightRangeLow  Float
  heightRangeHigh Float
  weightRangeLow  Int
  weightRangeHigh Int
  skinTexture     String?  @db.Text
  skinTones       String[]
  hairTexture     String?  @db.Text
  hairColors      String[]

  playstyle String? @db.Text

  defaultCreatureSizeId String
  defaultCreatureSize   CreatureSize @relation(fields: [defaultCreatureSizeId], references: [id])

  namesId              String?    @unique
  names                RaceName?  @relation(fields: [namesId], references: [id], onDelete: Cascade)
  additionalProperties Json?
  languages            Language[]

  subraces                Subrace[]
  subclassRecommendations RaceSubclassRecommendation[]
  continentLocations      RaceContinent[]
  deityRecommendations    DeityRecommendation[]        @relation("RaceDeityRecs")
  characters              Character[]
  worlds                  World[]
}

model RaceName {
  id      String   @id @default(uuid())
  seeded  Boolean  @default(false)
  male    String[]
  female  String[]
  unisex  String[]
  surname String[]

  raceId String?
  race   Race?

  subraceId            String?
  subrace              Subrace?
  additionalProperties Json?
}

model RaceContinent {
  id        String  @id @default(uuid())
  reasoning String  @db.Text
  seeded    Boolean @default(false)

  raceId               String
  race                 Race      @relation(fields: [raceId], references: [id], onDelete: Cascade)
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  additionalProperties Json?

  @@unique([raceId, continentId])
}

model SubraceContinent {
  id        String  @id @default(uuid())
  reasoning String  @db.Text
  seeded    Boolean @default(false)

  subraceId            String
  subrace              Subrace   @relation(fields: [subraceId], references: [id], onDelete: Cascade)
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  additionalProperties Json?

  @@unique([subraceId, continentId])
}

model SubclassContinent {
  id        String  @id @default(uuid())
  reasoning String  @db.Text
  seeded    Boolean @default(false)

  subclassId           String
  subclass             Subclass  @relation(fields: [subclassId], references: [id], onDelete: Cascade)
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  additionalProperties Json?

  @@unique([subclassId, continentId])
}

model Language {
  id          String  @id @default(uuid())
  seeded      Boolean @default(false)
  name        String
  description String? @db.Text

  races                Race[]
  continentsPrimary    Continent[] @relation("PrimaryLanguages")
  continentsSecondary  Continent[] @relation("SecondaryLanguages")
  continentsRare       Continent[] @relation("RareLanguages")
  characters           Character[]
  additionalProperties Json?
}

model Subrace {
  id          String  @id @default(uuid())
  name        String
  description String  @db.Text
  playstyle   String? @db.Text
  seeded      Boolean @default(false)

  speedOverride           String?
  ageAdulthoodOverride    Int?
  ageLifespanOverride     Int?
  heightRangeHighOverride Float?
  heightRangeLowOverride  Float?
  weightRangeHighOverride Int?
  weightRangeLowOverride  Int?
  skinTonesOverrideAppend  Boolean   @default(false)
  skinTonesOverride        String[]
  hairColorsOverrideAppend Boolean   @default(false)
  hairColorsOverride       String[]

  namesOverrideAppend  Boolean   @default(false)
  namesIdOverride      String?   @unique
  namesOverride        RaceName? @relation(fields: [namesIdOverride], references: [id], onDelete: Cascade)
  additionalProperties Json?
  raceId               String
  race                 Race      @relation(fields: [raceId], references: [id], onDelete: Cascade)

  worlds                  World[]
  continentLocations      SubraceContinent[]
  subclassRecommendations SubraceSubclassRecommendation[]
  deityRecommendations    DeityRecommendation[]           @relation("SubraceDeityRecs")
  characters              Character[]
}

model ClassRole {
  id                   String   @id @unique @default(uuid())
  name                 String   @unique
  seeded               Boolean  @default(false)
  purpose              String?
  keyTraits            String[]
  additionalProperties Json?
  classes              Class[]
}

model Class {
  id                   String      @id @default(uuid())
  name                 String      @unique
  description          String      @db.Text
  roles                ClassRole[]
  playstyle            String?     @db.Text
  seeded               Boolean     @default(false)
  additionalProperties Json?

  worlds               World[]
  subclasses           Subclass[]
  playstyleCategories  PlaystyleClassRecommendation[]
  deityRecommendations DeityRecommendation[]          @relation("ClassDeityRecs")
  characters           Character[]
}

model Subclass {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  playstyle            String? @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?

  classId                String
  class                  Class                           @relation(fields: [classId], references: [id], onDelete: Cascade)
  worlds                 World[]
  raceRecommendations    RaceSubclassRecommendation[]
  subraceRecommendations SubraceSubclassRecommendation[]
  contientLocations      SubclassContinent[]
  deityRecommendations   DeityRecommendation[]           @relation("SubclassDeityRecs")
  characters             Character[]
}

model RaceSubclassRecommendation {
  id                   String   @id @default(uuid())
  reasoning            String   @db.Text
  seeded               Boolean  @default(false)
  additionalProperties Json?
  raceId               String
  race                 Race     @relation(fields: [raceId], references: [id], onDelete: Cascade)
  subclassId           String
  subclass             Subclass @relation(fields: [subclassId], references: [id], onDelete: Cascade)

  @@unique([raceId, subclassId])
}

model SubraceSubclassRecommendation {
  id                   String   @id @default(uuid())
  reasoning            String   @db.Text
  seeded               Boolean  @default(false)
  additionalProperties Json?
  subraceId            String
  subrace              Subrace  @relation(fields: [subraceId], references: [id], onDelete: Cascade)
  subclassId           String
  subclass             Subclass @relation(fields: [subclassId], references: [id], onDelete: Cascade)

  @@unique([subraceId, subclassId])
}

// ============================================================================
// PANTHEON & DEITIES
// ============================================================================

model Pantheon {
  id                   String  @id @default(uuid())
  name                 String  @unique
  description          String  @db.Text
  symbol               String?
  seeded               Boolean @default(false)
  additionalProperties Json?
  deities              Deity[]
  worlds               World[]
}

model Deity {
  id                   String         @id @default(uuid())
  name                 String         @unique
  title                String?
  symbol               String?
  description          String         @db.Text
  temples              String?        @db.Text
  seeded               Boolean        @default(false)
  additionalProperties Json?
  pantheonId           String
  pantheon             Pantheon       @relation(fields: [pantheonId], references: [id])
  worlds               World[]
  domains              String[]
  followers            String[]
  holyDays             DeityHolyDay[]
  symbols              String[]
  colors               String[]
  history              DeityHistory[]

  alliesFrom DeityRelationship[] @relation("DeityFrom")
  alliesTo   DeityRelationship[] @relation("DeityTo")

  recommendations DeityRecommendation[]
  characters      Character[]
}

model DeityHolyDay {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?
  date                 String?

  deityId String
  deity   Deity  @relation(fields: [deityId], references: [id], onDelete: Cascade)
}

model DeityHistory {
  id                   String           @id @default(uuid())
  eraId                String
  era                  HistoricalPeriod @relation(fields: [eraId], references: [id], onDelete: Cascade)
  description          String?          @db.Text
  seeded               Boolean          @default(false)
  additionalProperties Json?
  deityId              String
  deity                Deity            @relation(fields: [deityId], references: [id], onDelete: Cascade)
}

enum DeityRelationshipCategory {
  ALLY
  CONFLICT
  FAMILIAL
}

model DeityRelationship {
  id                   String                    @id @default(uuid())
  type                 DeityRelationshipCategory
  reasoning            String?                   @db.Text
  seeded               Boolean                   @default(false)
  additionalProperties Json?
  deityId              String
  deity                Deity                     @relation("DeityFrom", fields: [deityId], references: [id], onDelete: Cascade)
  relatedDeityId       String
  relatedDeity         Deity                     @relation("DeityTo", fields: [relatedDeityId], references: [id], onDelete: Cascade)

  @@unique([deityId, relatedDeityId, type])
}

model DeityRecommendation {
  id                   String     @id @default(uuid())
  isPrimary            Boolean    @default(true)
  reasoning            String?    @db.Text
  additionalProperties Json?
  deityId              String
  deity                Deity      @relation(fields: [deityId], references: [id], onDelete: Cascade)
  raceId               String?
  race                 Race?      @relation("RaceDeityRecs", fields: [raceId], references: [id])
  subraceId            String?
  subrace              Subrace?   @relation("SubraceDeityRecs", fields: [subraceId], references: [id])
  classId              String?
  class                Class?     @relation("ClassDeityRecs", fields: [classId], references: [id])
  subclassId           String?
  subclass             Subclass?  @relation("SubclassDeityRecs", fields: [subclassId], references: [id])
  continentId          String?
  continent            Continent? @relation(fields: [continentId], references: [id])
}

// ============================================================================
// GUILDS & MEMBERS
// ============================================================================

model GuildRank {
  id                   String             @id @unique @default(uuid())
  name                 String             @unique
  imagePath            String?
  levelLow             Int                @unique
  levelHigh            Int                @unique
  additionalProperties Json?
  guild                Guild[]
  guildStaff           GuildStaff[]
  guildMembers         GuildMember[]
  quests               Quest[]
  questParticipants    QuestParticipant[]
}

enum MemberStatus {
  ACTIVE
  INACTIVE
  DECEASED
  RETIRED
  MISSING
  HIATUS
  EXPELLED
  ABROAD
}

model Guild {
  id                   String        @id @default(uuid())
  name                 String        @unique
  description          String        @db.Text
  emblemPath           String?
  foundedDate          String?
  seeded               Boolean       @default(false)
  additionalProperties Json?
  worlds               World[]
  continents           Continent[]
  guildHalls           GuildHall[]
  roles                GuildRole[]
  staff                GuildStaff[]
  members              GuildMember[]
  quests               Quest[]
  guildMasterUsers     User[]        @relation("GuildMasters")
  guildMemberUsers     User[]        @relation("GuildMembers")
  guildRanks           GuildRank[]
}

model GuildRole {
  id                   String       @id @default(uuid())
  name                 String
  description          String?      @db.Text
  seeded               Boolean      @default(false)
  additionalProperties Json?
  guildStaff           GuildStaff[]
  guild                Guild[]
}

model GuildStaff {
  id                   String     @id @default(uuid())
  rankId               String
  rank                 GuildRank  @relation(fields: [rankId], references: [id])
  seeded               Boolean    @default(false)
  additionalProperties Json?
  guildRoleId          String
  guildRole            GuildRole  @relation(fields: [guildRoleId], references: [id], onDelete: Cascade)
  characterId          String     @unique
  character            Character  @relation(fields: [characterId], references: [id], onDelete: Cascade)
  guildId              String
  guild                Guild      @relation(fields: [guildId], references: [id], onDelete: Cascade)
  guildHallId          String?
  guildHall            GuildHall? @relation(fields: [guildHallId], references: [id])
}

model GuildMember {
  id                   String       @id @default(uuid())
  rankId               String
  rank                 GuildRank    @relation(fields: [rankId], references: [id])
  status               MemberStatus @default(ACTIVE)
  specialization       String?
  seeded               Boolean      @default(false)
  additionalProperties Json?
  characterId          String       @unique
  character            Character    @relation(fields: [characterId], references: [id], onDelete: Cascade)
  guildId              String
  guild                Guild        @relation(fields: [guildId], references: [id], onDelete: Cascade)

  tags                GuildMemberTag[]               @relation("GuildMemberTag")
  achievements        GuildMemberAchievement[]       @relation("GuildMemberAchievement")
  questParticipations QuestParticipant[]
  factionMemberships  FactionGuildMemberMembership[] @relation("FactionGuildMember")
}

model GuildMemberTag {
  id                   String        @id @unique @default(uuid())
  tag                  String
  additionalProperties Json?
  members              GuildMember[] @relation("GuildMemberTag")
}

model GuildMemberAchievement {
  id                   String        @id @default(uuid())
  name                 String
  description          String?       @db.Text
  additionalProperties Json?
  members              GuildMember[] @relation("GuildMemberAchievement")
}

model GuildHall {
  id                   String       @id @default(uuid())
  name                 String       @unique
  description          String?      @db.Text
  imagePath            String?
  services             String[]
  createdAt            DateTime     @default(now())
  updatedAt            DateTime     @updatedAt
  seeded               Boolean      @default(false)
  additionalProperties Json?
  guildId              String
  guild                Guild        @relation(fields: [guildId], references: [id], onDelete: Cascade)
  staff                GuildStaff[]
  graveyard            Graveyard?
  graveyardId          String?      @unique
  townId               String
  town                 Town         @relation(fields: [townId], references: [id], onDelete: Cascade)
}

// ============================================================================
// CHARACTERS
// ============================================================================

model Season {
  id                   String  @id @unique @default(uuid())
  name                 String  @unique
  description          String  @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?
  months               Month[]
  worlds               World[]
}

model Month {
  id                   String  @id @unique @default(uuid())
  name                 String  @unique
  description          String? @db.Text
  seeded               Boolean @default(false)
  daysInMonth          Int
  order                Int     @unique @default(autoincrement())
  additionalProperties Json?
  seasonId             String
  season               Season  @relation(fields: [seasonId], references: [id])

  worlds World[]
}

model WeekDay {
  id                   String  @id @unique @default(uuid())
  name                 String  @unique
  seeded               Boolean @default(false)
  order                Int     @unique @default(autoincrement())
  additionalProperties Json?
  worlds               World[]
}

model Character {
  id                   String   @id @default(uuid())
  name                 String
  level                Int      @default(1)
  backgroundSummary    String?  @db.Text
  imagePath            String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  additionalProperties Json?
  // Demographics
  gender               String?
  age                  Int?
  birthDate            String?

  // Physical & Personality
  physicalDescription String? @db.Text
  appearance          String? @db.Text
  personality         String? @db.Text
  gearLoadout         String? @db.Text
  keyAttributes       String? @db.Text
  ideals              String? @db.Text
  bonds               String? @db.Text
  flaws               String? @db.Text
  backstory           String? @db.Text

  // Languages
  languages Language[]

  // Relations to Core Data
  userId             String?
  user               User?             @relation(fields: [userId], references: [id], onDelete: Cascade)
  raceId             String
  race               Race              @relation(fields: [raceId], references: [id])
  subraceId          String?
  subrace            Subrace?          @relation(fields: [subraceId], references: [id])
  classId            String?
  class              Class?            @relation(fields: [classId], references: [id])
  subclassId         String?
  subclass           Subclass?         @relation(fields: [subclassId], references: [id])
  deityId            String?
  deity              Deity?            @relation(fields: [deityId], references: [id])
  deityReasoning     String?           @db.Text
  fromContinentId    String?
  fromContinent      Continent?        @relation(fields: [fromContinentId], references: [id])
  fromTownId         String?
  fromTown           Town?             @relation("homeTown", fields: [fromTownId], references: [id])
  livesInTownId      String?
  livesInTown        Town?             @relation("LivesInTown", fields: [livesInTownId], references: [id])
  familyGenerationId String?
  familyGeneration   FamilyGeneration? @relation(fields: [familyGenerationId], references: [id])

  worlds         World[]
  creatureSizeId String
  creatureSize   CreatureSize @relation(fields: [creatureSizeId], references: [id])
  creatureTypeId String
  creatureType   CreatureType @relation(fields: [creatureTypeId], references: [id])

  // Character Role Links
  guildMember             GuildMember?
  guildStaff              GuildStaff?
  questAuthor             Quest[]
  continentRuler          CharacterContinentRuler?
  kingdomRuler            CharacterKingdomRuler?
  townJobs                CharacterTownJob[]
  factionRelationships    CharacterFactionRelationship[]
  npcFactionMemberships   FactionNPCMembership[]
  guildFactionMemberships FactionGuildMemberMembership[] @relation("FactionGuildMemberChar")
  relationshipsFrom       CharacterRelationship[]        @relation("CharacterFrom")
  relationshipsTo         CharacterRelationship[]        @relation("CharacterTo")

  // Quest & Gameplay
  quests QuestMemberReport[]

  // Graveyard
  graveyardEntry GraveyardEntry?
}

model FamilyGeneration {
  id                   String     @id @default(uuid())
  generationNumber     Int
  additionalProperties Json?
  familyTreeId         String
  familyTree           FamilyTree @relation(fields: [familyTreeId], references: [id], onDelete: Cascade)

  characters Character[]

  @@unique([familyTreeId, generationNumber])
}

model FamilyTree {
  id                   String                  @id @default(uuid())
  name                 String?
  description          String?                 @db.Text
  additionalProperties Json?
  generations          FamilyGeneration[]
  memberRelationships  CharacterRelationship[]
  worlds               World[]
}

// Character Role Links
model CharacterTownJob {
  id                   String        @id @default(uuid())
  jobTitle             String?
  description          String?       @db.Text
  additionalProperties Json?
  characterId          String
  character            Character     @relation(fields: [characterId], references: [id], onDelete: Cascade)
  townId               String?
  town                 Town?         @relation(fields: [townId], references: [id], onDelete: Cascade)
  professionId         String
  profession           NPCProfession @relation(fields: [professionId], references: [id])
  shopId               String?
  shop                 Shop?         @relation(fields: [shopId], references: [id], onDelete: Cascade)
}

model CharacterKingdomRuler {
  id                   String    @id @default(uuid())
  name                 String    @unique
  title                String?
  rulingStyle          String?   @db.Text
  startedRulingCycle   Int?
  additionalProperties Json?
  seeded               Boolean   @default(false)
  characterId          String    @unique
  character            Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  kingdomId            String    @unique
  kingdom              Kingdom   @relation(fields: [kingdomId], references: [id], onDelete: Cascade)
}

model CharacterContinentRuler {
  id                   String    @id @default(uuid())
  name                 String    @unique
  title                String?
  rulingStyle          String?   @db.Text
  startedRulingCycle   Int?
  additionalProperties Json?
  characterId          String    @unique
  character            Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  continentId          String    @unique
  continent            Continent @relation(fields: [continentId], references: [id], onDelete: Cascade)
}

// Character Relationships
model CharacterRelationship {
  id                   String    @id @default(uuid())
  description          String?   @db.Text
  additionalProperties Json?
  fromCharacterId      String
  fromCharacter        Character @relation("CharacterFrom", fields: [fromCharacterId], references: [id], onDelete: Cascade)
  toCharacterId        String
  toCharacter          Character @relation("CharacterTo", fields: [toCharacterId], references: [id], onDelete: Cascade)

  relationshipTypeId String
  relationshipType   CharacterRelationshipType @relation(fields: [relationshipTypeId], references: [id])
  familyTreeId       String?
  familyTree         FamilyTree?               @relation(fields: [familyTreeId], references: [id], onDelete: Cascade)

  @@unique([fromCharacterId, toCharacterId, relationshipTypeId])
}

// Graveyard
model Graveyard {
  id                   String     @id @default(uuid())
  name                 String?
  description          String?    @db.Text
  additionalProperties Json?
  townId               String?    @unique
  town                 Town?      @relation(fields: [townId], references: [id], onDelete: Cascade)
  factionId            String?    @unique
  faction              Faction?   @relation(fields: [factionId], references: [id], onDelete: Cascade)
  guildHallId          String?    @unique
  guildHall            GuildHall? @relation(fields: [guildHallId], references: [id])

  entries GraveyardEntry[]
}

model GraveyardEntry {
  id                   String  @id @default(uuid())
  causeOfDeath         String? @db.Text
  headstoneInscription String? @db.Text

  deathDate            String?
  additionalProperties Json?
  characterId          String    @unique
  character            Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  graveyardId          String
  graveyard            Graveyard @relation(fields: [graveyardId], references: [id], onDelete: Cascade)
}

// ============================================================================
// QUESTS
// ============================================================================

model Quest {
  id                   String     @id @default(uuid())
  name                 String
  description          String     @db.Text
  rankId               String?
  rank                 GuildRank? @relation(fields: [rankId], references: [id])
  commissionedById     String?
  commissionedBy       Character? @relation(fields: [commissionedById], references: [id])
  dateCommissioned     String?
  dateDue              String?
  dateCompleted        String?
  location             String?
  outcome              String?
  extraNotes           String?    @db.Text
  seeded               Boolean    @default(false)
  additionalProperties Json?
  guildId              String
  guild                Guild      @relation(fields: [guildId], references: [id], onDelete: Cascade)
  townId               String?
  town                 Town?      @relation(fields: [townId], references: [id], onDelete: Cascade)
  continentId          String?
  continent            Continent? @relation(fields: [continentId], references: [id], onDelete: Cascade)

  participants  QuestParticipant[]
  enemies       QuestEnemy[]
  awards        QuestAward[]
  loot          QuestLoot[]
  memberReports QuestMemberReport[]
  fallenMembers QuestFallenMember[]
}

model QuestParticipant {
  id                   String      @id @default(uuid())
  rankAtTimeId         String
  rankAtTime           GuildRank   @relation(fields: [rankAtTimeId], references: [id])
  role                 String?
  additionalProperties Json?
  questId              String
  quest                Quest       @relation(fields: [questId], references: [id], onDelete: Cascade)
  memberId             String
  member               GuildMember @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@unique([questId, memberId])
}

model QuestEnemy {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  quantity             Int?
  additionalProperties Json?
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id], onDelete: Cascade)
}

model QuestAward {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  additionalProperties Json?
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id], onDelete: Cascade)
}

model QuestLoot {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  quantity             Int?
  additionalProperties Json?
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id], onDelete: Cascade)
}

model QuestMemberReport {
  id                   String     @id @default(uuid())
  report               String     @db.Text
  memberName           String?
  additionalProperties Json?
  questId              String
  quest                Quest      @relation(fields: [questId], references: [id], onDelete: Cascade)
  characterId          String?
  character            Character? @relation(fields: [characterId], references: [id])
}

model QuestFallenMember {
  id                   String  @id @default(uuid())
  memberName           String
  cause                String? @db.Text
  additionalProperties Json?
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id], onDelete: Cascade)
}

// ============================================================================
// NPCs & PROFESSIONS
// ============================================================================

model NPCProfession {
  id                     String                           @id @default(uuid())
  name                   String                           @unique
  description            String?                          @db.Text
  category               String?
  seeded                 Boolean                          @default(false)
  additionalProperties   Json?
  restrictedToContinents ProfessionContinentRestriction[]
  restrictedToTowns      ProfessionTownRestriction[]
  characterJobs          CharacterTownJob[]
}

model ProfessionContinentRestriction {
  id                   String        @id @unique @default(uuid())
  additionalProperties Json?
  professionId         String
  profession           NPCProfession @relation(fields: [professionId], references: [id], onDelete: Cascade)
  continentId          String
  continent            Continent     @relation(fields: [continentId], references: [id], onDelete: Cascade)

  @@unique([professionId, continentId])
}

model ProfessionTownRestriction {
  id                   String        @id @unique @default(uuid())
  additionalProperties Json?
  professionId         String
  profession           NPCProfession @relation(fields: [professionId], references: [id], onDelete: Cascade)
  townId               String
  town                 Town          @relation(fields: [townId], references: [id], onDelete: Cascade)

  @@unique([professionId, townId])
}

model CharacterRelationshipType {
  id                     String                  @id @default(uuid())
  name                   String                  @unique
  description            String?
  seeded                 Boolean                 @default(false)
  additionalProperties   Json?
  characterRelationships CharacterRelationship[]
}

// ============================================================================
// FACTIONS
// ============================================================================

enum FactionInfluenceLevel {
  MINOR
  MODERATE
  MAJOR
  DOMINANT
  HIDDEN
}

enum CharacterFactionRelationshipType {
  MEMBER
  LEADER
  FORMER_MEMBER
  ALLY
  ENEMY
  NEUTRAL
  RIVAL
  SUPPORTER
}

model Faction {
  id                     String                         @id @default(uuid())
  name                   String                         @unique
  description            String                         @db.Text
  mainPurpose            String                         @db.Text
  emblemPath             String?
  foundedCycle           Int?
  seeded                 Boolean                        @default(false)
  createdAt              DateTime                       @default(now())
  updatedAt              DateTime                       @updatedAt
  additionalProperties   Json?
  worlds                 World[]
  continentPresence      FactionContinentPresence[]
  bases                  FactionBase[]
  npcMembers             FactionNPCMembership[]
  guildMembers           FactionGuildMemberMembership[]
  characterRelationships CharacterFactionRelationship[]
  relationshipsFrom      FactionRelationship[]          @relation("FactionFrom")
  relationshipsTo        FactionRelationship[]          @relation("FactionTo")
  townRelationships      FactionTownRelationship[]
  historicEvents         FactionHistoricEvent[]
  graveyard              Graveyard?
}

model FactionContinentPresence {
  id                   String                @id @default(uuid())
  influenceLevel       FactionInfluenceLevel
  description          String?               @db.Text
  additionalProperties Json?
  factionId            String
  faction              Faction               @relation(fields: [factionId], references: [id], onDelete: Cascade)
  continentId          String
  continent            Continent             @relation(fields: [continentId], references: [id])

  @@unique([factionId, continentId])
}

model FactionBase {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  townRelationship     String  @db.Text
  isHeadquarters       Boolean @default(false)
  isSecret             Boolean @default(false)
  seeded               Boolean @default(false)
  additionalProperties Json?
  factionId            String
  faction              Faction @relation(fields: [factionId], references: [id], onDelete: Cascade)
  townId               String
  town                 Town    @relation(fields: [townId], references: [id])

  npcMembers   FactionNPCMembership[]
  guildMembers FactionGuildMemberMembership[]

  @@unique([factionId, townId, name])
}

model FactionRole {
  id                   String                         @id @default(uuid())
  name                 String                         @unique
  description          String?                        @db.Text
  rankOrder            Int                            @default(0)
  seeded               Boolean                        @default(false)
  additionalProperties Json?
  npcMemberships       FactionNPCMembership[]
  guildMemberships     FactionGuildMemberMembership[]
}

model FactionNPCMembership {
  id                   String       @id @default(uuid())
  joinedCycle          Int?
  notes                String?      @db.Text
  isSecret             Boolean      @default(false)
  additionalProperties Json?
  factionId            String
  faction              Faction      @relation(fields: [factionId], references: [id], onDelete: Cascade)
  characterId          String
  character            Character    @relation(fields: [characterId], references: [id], onDelete: Cascade)
  roleId               String
  role                 FactionRole  @relation(fields: [roleId], references: [id])
  baseId               String?
  base                 FactionBase? @relation(fields: [baseId], references: [id])

  @@unique([factionId, characterId])
}

model FactionGuildMemberMembership {
  id                   String       @id @default(uuid())
  joinedCycle          Int?
  notes                String?      @db.Text
  isSecret             Boolean      @default(false)
  additionalProperties Json?
  factionId            String
  faction              Faction      @relation(fields: [factionId], references: [id], onDelete: Cascade)
  guildMemberId        String
  guildMember          GuildMember  @relation("FactionGuildMember", fields: [guildMemberId], references: [id], onDelete: Cascade)
  characterId          String
  character            Character    @relation("FactionGuildMemberChar", fields: [characterId], references: [id], onDelete: Cascade)
  roleId               String
  role                 FactionRole  @relation(fields: [roleId], references: [id])
  baseId               String?
  base                 FactionBase? @relation(fields: [baseId], references: [id])

  @@unique([factionId, guildMemberId])
  @@unique([factionId, characterId])
}

model FactionRelationshipType {
  id                   String                @id @default(uuid())
  name                 String                @unique
  description          String?               @db.Text
  seeded               Boolean               @default(false)
  additionalProperties Json?
  relationships        FactionRelationship[]
}

model FactionRelationship {
  id                   String  @id @default(uuid())
  description          String? @db.Text
  since                Int?
  additionalProperties Json?
  fromFactionId        String
  fromFaction          Faction @relation("FactionFrom", fields: [fromFactionId], references: [id], onDelete: Cascade)
  toFactionId          String
  toFaction            Faction @relation("FactionTo", fields: [toFactionId], references: [id], onDelete: Cascade)

  relationshipTypeId String
  relationshipType   FactionRelationshipType @relation(fields: [relationshipTypeId], references: [id])

  @@unique([fromFactionId, toFactionId])
}

// Character-Faction Relationships
model CharacterFactionRelationship {
  id                   String                           @id @default(uuid())
  type                 CharacterFactionRelationshipType
  notes                String?                          @db.Text
  additionalProperties Json?
  characterId          String
  character            Character                        @relation(fields: [characterId], references: [id], onDelete: Cascade)
  factionId            String
  faction              Faction                          @relation(fields: [factionId], references: [id], onDelete: Cascade)

  @@unique([characterId, factionId, type])
}

// Faction-Town Relationships
model FactionTownRelationship {
  id                   String  @id @default(uuid())
  description          String? @db.Text
  relationshipType     String // e.g., "ALLIED", "HOSTILE", "NEUTRAL", "CONTROLS", etc.
  additionalProperties Json?
  factionId            String
  faction              Faction @relation(fields: [factionId], references: [id], onDelete: Cascade)
  townId               String
  town                 Town    @relation(fields: [townId], references: [id], onDelete: Cascade)

  @@unique([factionId, townId])
}

// Faction Historic Events
model FactionHistoricEvent {
  id                   String  @id @unique @default(uuid())
  name                 String
  description          String  @db.Text
  eventType            String // e.g., "FOUNDING", "LEADERSHIP_CHANGE", "ENEMY_DECLARED", "ALLY_FORMED", "ACHIEVEMENT", "MILESTONE"
  additionalProperties Json?
  eventDate            String?

  factionId String
  faction   Faction @relation(fields: [factionId], references: [id], onDelete: Cascade)

  @@index([factionId])
}

// ============================================================================
// PLAYSTYLE GUIDE
// ============================================================================

model PlaystyleCategory {
  id                   String                         @id @default(uuid())
  name                 String                         @unique
  description          String                         @db.Text
  seeded               Boolean                        @default(false)
  additionalProperties Json?
  recommendations      PlaystyleClassRecommendation[]
}

model PlaystyleClassRecommendation {
  id                   String            @id @default(uuid())
  reasoning            String?           @db.Text
  additionalProperties Json?
  playstyleId          String
  playstyle            PlaystyleCategory @relation(fields: [playstyleId], references: [id], onDelete: Cascade)
  classId              String
  class                Class             @relation(fields: [classId], references: [id], onDelete: Cascade)

  @@unique([playstyleId, classId])
}

model AbilityScorePriority {
  id                   String                   @id @default(uuid())
  ability              String                   @unique
  description          String                   @db.Text
  seeded               Boolean                  @default(false)
  additionalProperties Json?
  bestClasses          AbilityScoreClass[]
  importantFor         AbilityScoreImportance[]
}

model AbilityScoreClass {
  id                   String               @id @unique @default(uuid())
  additionalProperties Json?
  abilityId            String
  ability              AbilityScorePriority @relation(fields: [abilityId], references: [id], onDelete: Cascade)
  className            String
}

model AbilityScoreImportance {
  id                   String               @id @default(uuid())
  importance           String
  description          String?              @db.Text
  additionalProperties Json?
  abilityId            String
  ability              AbilityScorePriority @relation(fields: [abilityId], references: [id], onDelete: Cascade)
}

model RoleDescription {
  id                   String           @id @default(uuid())
  name                 String           @unique
  description          String           @db.Text
  seeded               Boolean          @default(false)
  additionalProperties Json?
  keyAbilities         RoleKeyAbility[]
  bestClasses          RoleBestClass[]
}

model RoleKeyAbility {
  id                   String          @id @unique @default(uuid())
  ability              String
  additionalProperties Json?
  roleId               String
  role                 RoleDescription @relation(fields: [roleId], references: [id], onDelete: Cascade)
}

model RoleBestClass {
  id                   String          @id @unique @default(uuid())
  className            String
  additionalProperties Json?
  roleId               String
  role                 RoleDescription @relation(fields: [roleId], references: [id], onDelete: Cascade)
}

model ComplexityLevel {
  id                   String            @id @default(uuid())
  level                String            @unique
  description          String            @db.Text
  seeded               Boolean           @default(false)
  additionalProperties Json?
  classes              ComplexityClass[]
}

model ComplexityClass {
  id                   String          @id @unique @default(uuid())
  className            String
  additionalProperties Json?
  complexityId         String
  complexity           ComplexityLevel @relation(fields: [complexityId], references: [id], onDelete: Cascade)
}

// ============================================================================
// MONSTER SLAYERS GUIDE (BESTIARY)
// ============================================================================

enum ContinentCreatureRelation {
  PRIMARY
  SECONDARY
  RARE
}

model ContinentCreatureType {
  id                   String                    @id @default(uuid())
  seeded               Boolean                   @default(false)
  relation             ContinentCreatureRelation
  reasoning            String?                   @db.Text
  additionalProperties Json?
  continentId          String
  continent            Continent                 @relation(fields: [continentId], references: [id], onDelete: Cascade)
  creatureTypeId       String
  creatureType         CreatureType              @relation(fields: [creatureTypeId], references: [id], onDelete: Cascade)

  @@unique([continentId, creatureTypeId])
}

model RegionCreatureType {
  id                   String       @id @default(uuid())
  seeded               Boolean      @default(false)
  reasoning            String?      @db.Text
  additionalProperties Json?
  regionId             String
  region               Region       @relation(fields: [regionId], references: [id], onDelete: Cascade)
  creatureTypeId       String
  creatureType         CreatureType @relation(fields: [creatureTypeId], references: [id], onDelete: Cascade)

  @@unique([regionId, creatureTypeId])
}

model CreatureType {
  id                   String                  @id @default(uuid())
  name                 String                  @unique
  description          String                  @db.Text
  habits               String?                 @db.Text
  tactics              String?                 @db.Text
  weaknesses           String?                 @db.Text
  seeded               Boolean                 @default(false)
  additionalProperties Json?
  commonSizes          CreatureSize[]          @relation("CreatureTypeCommonSizes")
  worlds               World[]
  continents           ContinentCreatureType[]
  regions              RegionCreatureType[]
  characters           Character[]
  legendaryCreatures   LegendaryCreature[]
}

model CreatureSize {
  id                   String              @id @default(uuid())
  seeded               Boolean             @default(false)
  name                 String              @unique
  occupiedSpace        String
  heightRange          String
  weightRange          String
  description          String?             @db.Text
  additionalProperties Json?
  creatureTypes        CreatureType[]      @relation("CreatureTypeCommonSizes")
  races                Race[]
  characters           Character[]
  legendaryCreatures   LegendaryCreature[]
}

enum LegendaryCreatureThreatLevel {
  CITY
  REGIONAL
  CONTINENTAL
  GLOBAL
  INTERWORLD
}

model LegendaryCreature {
  id                   String                       @id @default(uuid())
  name                 String
  description          String                       @db.Text
  threatLevel          LegendaryCreatureThreatLevel
  questPotential       String?                      @db.Text
  isPast               Boolean                      @default(false)
  defeatedBy           String?
  defeatedByTitle      String?
  defeatStory          String?                      @db.Text
  legacy               String?                      @db.Text
  seeded               Boolean                      @default(false)
  additionalProperties Json?
  creatureSizeId       String
  creatureSize         CreatureSize                 @relation(fields: [creatureSizeId], references: [id], onDelete: Cascade)

  creatureTypeId String
  creatureType   CreatureType @relation(fields: [creatureTypeId], references: [id], onDelete: Cascade)

  continentId String
  continent   Continent @relation(fields: [continentId], references: [id])

  worlds World[]
}
