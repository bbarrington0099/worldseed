// WorldSeed Prisma Schema

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ============================================================================
// USER & AUTHENTICATION (Auth.js Compatible)
// ============================================================================

model UserRole {
  id                               String @id @default(cuid())
  name                             String @unique
  users                            User[]
  // Limits; set to -1 for unlimited
  worldOwnedLimit                  Int // number of worlds a user can own
  worldForgerLimit                 Int // number of worlds a user can forge not including their owned worlds (i.e., contribute to)
  contentPillarsPerWorldLimit      Int // e.g., races, classes, continents, pantheons, guilds, etc.
  contentStructuresPerPillarLimit  Int // e.g., towns, factions, landmarks, deities, quests, creature types, etc.
  contentElementsPerStructureLimit Int // e.g., shops, legendary creatures, family trees, historical events, etc.
  contentItemsPerWorldLimit        Int // e.g., quests, characters, etc.
  apiCallLimitPerDay               Int // number of API calls a user can make per day
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  emailVerified DateTime?
  image         String?

  roleId String
  role   UserRole @relation(fields: [roleId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Auth.js relations
  accounts Account[]
  sessions Session[]
  apiKeys  ApiKey[]

  // App relations
  masterOfFactions Faction[]   @relation("FactionMasters")
  memberOfFactions Faction[]   @relation("FactionMembers")
  characters       Character[]

  createdClasses           Class[]
  createdClassCollections  ClassCollection[] @relation("UserCreatedClassCollections")
  importedClassCollections ClassCollection[] @relation("UserImportedClassCollections")
  createdRaces             Race[]
  createdRaceCollections   RaceCollection[]  @relation("UserCreatedRaceCollections")
  importedRaceCollections  RaceCollection[]  @relation("UserImportedRaceCollections")
  createdDeities           Deity[]
  createdDeityCollections  DeityCollection[] @relation("UserCreatedDeityCollections")
  importedDeityCollections DeityCollection[] @relation("UserImportedDeityCollections")

  ownedWorlds    World[]
  forgedWorlds   World[] @relation("WorldForgers")
  occupiedWorlds World[] @relation("WorldOccupants")
}

model Account {
  id                String @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String

  passwordHash       String?  @db.Text
  mustChangePassword Boolean?

  refresh_token String? @db.Text
  access_token  String? @db.Text
  expires_at    Int?
  token_type    String?
  scope         String?
  id_token      String? @db.Text
  session_state String?

  user User @relation(fields: [userId], references: [id])

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  user User @relation(fields: [userId], references: [id])
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model ApiKey {
  id        String   @id @default(cuid())
  key       String   @unique
  createdAt DateTime @default(now())
  revoked   Boolean  @default(false)

  userId String
  user   User   @relation(fields: [userId], references: [id])

  worldId String
  world   World  @relation(fields: [worldId], references: [id])

  @@unique([userId, worldId])
}

// ============================================================================
// WORLD & GEOGRAPHY
// ============================================================================

model World {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  public               Boolean @default(false) // if false, only owner, forgers, and occupants can access, for true, anyone can see the world and explore it's content
  name                 String
  description          String  @db.Text
  measurementUnit      String  @default("miles")
  circumference        Int?
  diameter             Int?
  surfaceAreaSq        BigInt?
  currentDate          String?
  yearCalled           String  @default("years")
  mapPath              String?
  emblemPath           String?
  additionalProperties Json?
  deleted              Boolean @default(false)

  historicalPeriods HistoricalPeriod[]
  historyEvents     HistoricalEvent[]
  continents        Continent[]
  kingdoms          Kingdom[]

  connectedWorlds    World[]             @relation("ConnectedWorlds")
  connectedToWorlds  World[]             @relation("ConnectedWorlds")
  races              Race[]
  subraces           Subrace[]
  classes            Class[]
  subclasses         Subclass[]
  pantheons          Pantheon[]
  deities            Deity[]
  characters         Character[]
  creatureTypes      CreatureType[]
  creatures          Creature[]
  legendaryCreatures LegendaryCreature[]
  factions           Faction[]
  seasons            Season[]
  months             Month[]
  weekDays           WeekDay[]
  familyTrees        FamilyTree[]
  powerSystems       PowerSystem[]

  ownerId                         String
  owner                           User     @relation(fields: [ownerId], references: [id])
  apiKeys                         ApiKey[]
  forgersCanConnectTo             Boolean  @default(true) // allows forgers to connect their worlds to this world
  forgersCanSeedFrom              Boolean  @default(true) // allows forgers to use data from this world when seeding their own worlds
  forgersCanSeedTo                Boolean  @default(true) // allows forgers to seed this world using data from their own worlds
  forgers                         User[]   @relation("WorldForgers")
  occupantsCanConnectTo           Boolean  @default(false) // allows occupants to connect their worlds to this world
  occupantsCanSeedFrom            Boolean  @default(false) // allows occupants to use data from this world when seeding their own worlds
  occupantsCharacterCreationLimit Int      @default(1) // number of characters an occupant can create in this world, occupants can only create characters and connections for those characters, no other content
  occupants                       User[]   @relation("WorldOccupants")

  importedRaceCollections  RaceCollection[]
  importedClassCollections ClassCollection[]
  importedDeityCollections DeityCollection[]
}

model PowerSystem {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?
  deleted              Boolean @default(false)

  worlds World[]

  powers Power[]
}

model Power {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  type                 String
  magnitude            Int?
  frequency            String?
  limitations          String? @db.Text
  additionalProperties Json?
  deleted              Boolean @default(false)

  powerSystemId String
  powerSystem   PowerSystem @relation(fields: [powerSystemId], references: [id])

  characters         Character[]
  creatures          Creature[]
  legendaryCreatures LegendaryCreature[]
}

model Continent {
  id                String  @id @default(uuid())
  seeded            Boolean @default(false)
  name              String
  description       String  @db.Text
  widthMi           Int?
  heightMi          Int?
  surfaceAreaSqMi   BigInt?
  languageReasoning String? @db.Text

  // Flag/Colors
  primaryColor    String?
  secondaryColor  String?
  flagSymbol      String?
  flagDescription String? @db.Text
  mapImagePath    String?
  flagImagePath   String?

  // Politics
  governmentType      GovernmentType
  politicalStructure  String?        @db.Text
  majorPoliticalIssue String?        @db.Text
  foreignRelations    String?        @db.Text

  additionalProperties Json?
  deleted              Boolean @default(false)

  // Relations
  worldId   String
  world     World    @relation(fields: [worldId], references: [id])
  kingdomId String?
  kingdom   Kingdom? @relation(fields: [kingdomId], references: [id])

  capitalTownId String? @unique
  capitalTown   Town?   @relation("ContinentCapital", fields: [capitalTownId], references: [id])

  capitalOfKingdom Kingdom? @relation("KingdomCapital")

  towns              Town[]             @relation("PartOfContient")
  regions            Region[]
  stateInPeriods     ContinentHistory[]
  primaryLanguages   Language[]         @relation("PrimaryLanguages")
  secondaryLanguages Language[]         @relation("SecondaryLanguages")
  rareLanguages      Language[]         @relation("RareLanguages")

  voyagesFrom   Voyage[]      @relation("FromContinent")
  voyagesTo     Voyage[]      @relation("ToContinent")
  warsConflicts WarConflict[]
  treaties      Treaty[]
  tradeRoutes   TradeRoute[]

  raceLocations          RaceContinent[]
  subraceLocations       SubraceContinent[]
  subclassLocations      SubclassContinent[]
  creatureTypes          ContinentCreatureType[]
  creatures              Creature[]
  legendaryCreatures     LegendaryCreature[]
  deityRecommendations   ContinentDeity[]
  historicalEvents       HistoricalEvent[]
  professionRestrictions ProfessionContinentRestriction[]
  factionBases           FactionBase[]
  factionPresence        FactionContinentPresence[]
  rulerId                String?
  ruler                  CharacterContinentRuler?
  charactersFrom         Character[]
  landmarks              Landmark[]
  quests                 Quest[]
}

model Landmark {
  id           String  @id @default(uuid())
  seeded       Boolean @default(false)
  name         String
  description  String  @db.Text
  location     String?
  significance String? @db.Text

  additionalProperties Json?
  deleted              Boolean @default(false)

  continentId String
  continent   Continent @relation(fields: [continentId], references: [id])
}

enum ContinentLanguagePrevalence {
  PRIMARY
  SECONDARY
  RARE
}

model Kingdom {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  description          String? @db.Text
  surfaceAreaSqMi      BigInt?
  primaryColor         String?
  secondaryColor       String?
  flagSymbol           String?
  flagDescription      String? @db.Text
  mapImagePath         String?
  flagImagePath        String?
  additionalProperties Json?
  deleted              Boolean @default(false)

  dateFounded   String?
  dateDissolved String?

  governmentType      GovernmentType
  politicalStructure  String?        @db.Text
  majorPoliticalIssue String?        @db.Text
  foreignRelations    String?        @db.Text

  worldId String
  world   World  @relation(fields: [worldId], references: [id])

  continents Continent[]
  regions    Region[]

  capitalContinentId String?    @unique
  capitalContinent   Continent? @relation("KingdomCapital", fields: [capitalContinentId], references: [id])

  rulerId String?
  ruler   CharacterKingdomRuler?
}

enum TownType {
  RUINS
  OUTPOST
  HAMLET
  VILLAGE
  TOWN
  CITY
  METROPOLIS
  CAPITAL
}

model Town {
  id          String   @id @default(uuid())
  seeded      Boolean  @default(false)
  name        String
  description String   @db.Text
  location    String?
  population  Int?
  type        TownType @default(VILLAGE)

  imagePath            String?
  additionalProperties Json?
  deleted              Boolean @default(false)

  continentId String
  continent   Continent @relation("PartOfContient", fields: [continentId], references: [id])

  capitalOfContinent Continent? @relation("ContinentCapital")

  regions                Region[]                    @relation("RegionTowns")
  factionBases           FactionBase[]
  professionRestrictions ProfessionTownRestriction[]
  characterJobs          CharacterProfession[]
  factionRelationships   FactionTownRelationship[]
  graveyardId            String?
  graveyard              Graveyard?                  @relation(fields: [graveyardId], references: [id])
  tripsFrom              Road[]                      @relation("FromTown")
  tripsTo                Road[]                      @relation("ToTown")
  tradeRoutes            TradeRoute[]
  shops                  Shop[]
  charactersFrom         Character[]                 @relation("homeTown")
  charactersLivingIn     Character[]                 @relation("LivesInTown")
  quests                 Quest[]
}

model Shop {
  id          String  @id @default(uuid())
  seeded      Boolean @default(false)
  name        String
  description String? @db.Text
  type        String?
  inventory   Json? // e.g., list of items or services, including prices, quantitiy, etc.
  // When creating a new shop, query for shops with the same type to generate inventory recommendations

  additionalProperties Json?
  deleted              Boolean @default(false)

  townId  String?
  town    Town?                 @relation(fields: [townId], references: [id])
  workers CharacterProfession[]
}

model Region {
  id                   String                      @id @default(uuid())
  seeded               Boolean                     @default(false)
  name                 String
  description          String?                     @db.Text
  createdAt            DateTime                    @default(now())
  updatedAt            DateTime                    @updatedAt
  kingdomId            String?
  kingdom              Kingdom?                    @relation(fields: [kingdomId], references: [id])
  continentId          String
  continent            Continent                   @relation(fields: [continentId], references: [id])
  creatureTypes        RegionCreatureType[]
  creatures            Creature[]
  factions             FactionRegionRelationship[]
  factionBases         FactionBase[]
  towns                Town[]                      @relation("RegionTowns")
  quests               Quest[]
  additionalProperties Json?
  deleted              Boolean                     @default(false)
}

model Voyage {
  id          String  @id @default(uuid())
  seeded      Boolean @default(false)
  name        String
  distanceMi  Int?
  travelDays  Int?
  travelHours Float?

  additionalProperties Json?
  deleted              Boolean @default(false)

  tradeRoutes     TradeRoute[]
  fromContinentId String
  fromContinent   Continent    @relation("FromContinent", fields: [fromContinentId], references: [id])
  toContinentId   String
  toContinent     Continent    @relation("ToContinent", fields: [toContinentId], references: [id])

  @@unique([fromContinentId, toContinentId])
}

model Road {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  distanceMi           Int?
  travelDays           Int?
  travelHours          Int?
  travelMinutes        Int?
  additionalProperties Json?
  deleted              Boolean @default(false)

  tradeRoutes TradeRoute[]
  fromTownId  String
  fromTown    Town         @relation("FromTown", fields: [fromTownId], references: [id])
  toTownId    String
  toTown      Town         @relation("ToTown", fields: [toTownId], references: [id])

  @@unique([fromTownId, toTownId])
}

enum GovernmentType {
  MONARCHY
  REPUBLIC
  DEMOCRACY
  THEOCRACY
  TRIBAL
  DICTATORSHIP
  OLIGARCHY
  ANARCHY
  EMPIRE
  CONCLAVE
}

enum WarConflictStatus {
  RESOLVED
  COLD_WAR
  LOW_INTENSITY
  HIGH_INTENSITY
}

model WarConflict {
  id                   String            @id @default(uuid())
  seeded               Boolean           @default(false)
  name                 String
  description          String?           @db.Text
  startDate            String?
  endDate              String?
  outcome              String?           @db.Text
  status               WarConflictStatus
  additionalProperties Json?
  deleted              Boolean           @default(false)

  continentsInvolved Continent[]
}

model Treaty {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  signedDate           String?
  terms                String? @db.Text
  additionalProperties Json?
  deleted              Boolean @default(false)

  continentsInvolved Continent[]
}

enum TradeRouteType {
  OVERLAND
  UNDERGROUND
  MARITIME
  UNDERWATER
  AERIAL
  OVERLAND_TO_MARITIME
  UNDERGROUND_TO_MARITIME
  INTERWORLD
}

enum TradeRouteFrequency {
  DAILY
  WEEKLY
  BI_WEEKLY
  MONTHLY
  YEARLY
  IRREGULAR
}

model TradeRoute {
  id                   String              @id @default(uuid())
  seeded               Boolean             @default(false)
  name                 String
  description          String?             @db.Text
  goods                String[]
  routeType            TradeRouteType
  frequency            TradeRouteFrequency
  additionalProperties Json?
  deleted              Boolean             @default(false)

  continentStops Continent[]
  voyages        Voyage[]
  townStops      Town[]
  roads          Road[]
}

// ============================================================================
// WORLD HISTORY & TIMELINE
// ============================================================================

model HistoricalPeriod {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  startCycle           Int
  endCycle             Int?
  description          String  @db.Text
  significance         String? @db.Text
  sortOrder            Int     @default(autoincrement())
  additionalProperties Json?
  deleted              Boolean @default(false)

  worldId String
  world   World  @relation(fields: [worldId], references: [id])

  deitysDuringPeriod     DeityHistory[]
  continentsDuringPeriod ContinentHistory[]
  events                 HistoricalEvent[]

  @@unique([worldId, sortOrder])
}

model ContinentHistory {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  description          String? @db.Text
  date                 String?
  additionalProperties Json?
  deleted              Boolean @default(false)

  continentId String
  continent   Continent @relation(fields: [continentId], references: [id])

  periodId String
  period   HistoricalPeriod @relation(fields: [periodId], references: [id])

  @@unique([continentId, periodId])
}

model HistoricalEvent {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  date                 String?
  additionalProperties Json?
  deleted              Boolean @default(false)
  description          String  @db.Text
  impact               String? @db.Text
  sortOrder            Int     @default(autoincrement())

  worldId     String?
  world       World?            @relation(fields: [worldId], references: [id])
  periodId    String?
  period      HistoricalPeriod? @relation(fields: [periodId], references: [id])
  continentId String?
  continent   Continent?        @relation(fields: [continentId], references: [id])

  @@unique([periodId, sortOrder])
}

// ============================================================================
// RACES & CLASSES
// ============================================================================

model Race {
  id           String  @id @default(uuid())
  seeded       Boolean @default(false)
  name         String
  description  String  @db.Text
  ageAdulthood Int // 0 created/spawned as adult
  ageLifespan  Int // 0 for indefinite, - for up to that many years with immortal potential

  heightRangeLow  Float
  heightRangeHigh Float
  weightRangeLow  Int
  weightRangeHigh Int
  skinTexture     String?  @db.Text
  skinTones       String[]
  hairTexture     String?  @db.Text
  hairColors      String[]

  playstyle String? @db.Text

  defaultCreatureSizeId String
  defaultCreatureSize   CreatureSize @relation(fields: [defaultCreatureSizeId], references: [id])

  namesId              String?
  names                RaceName?  @relation(fields: [namesId], references: [id])
  additionalProperties Json?
  deleted              Boolean    @default(false)
  languages            Language[]

  subraces                Subrace[]
  subclassRecommendations RaceSubclassRecommendation[]
  continentLocations      RaceContinent[]
  deityRecommendations    RaceDeity[]
  characters              Character[]
  worlds                  World[]
  collections             RaceCollection[]
  creatorId               String?
  creator                 User?                        @relation(fields: [creatorId], references: [id])
}

model RaceCollection {
  id               String  @id @default(uuid())
  name             String
  seeded           Boolean @default(false)
  races            Race[]
  importedToWorlds World[]

  creatorId String
  creator   User   @relation("UserCreatedRaceCollections", fields: [creatorId], references: [id])
  importers User[] @relation("UserImportedRaceCollections")
}

model RaceName {
  id      String   @id @default(uuid())
  seeded  Boolean  @default(false)
  male    String[]
  female  String[]
  unisex  String[]
  surname String[]

  races Race[]

  subraces             Subrace[]
  additionalProperties Json?
  deleted              Boolean   @default(false)
}

model RaceContinent {
  id        String  @id @default(uuid())
  reasoning String  @db.Text
  seeded    Boolean @default(false)

  raceId               String
  race                 Race      @relation(fields: [raceId], references: [id])
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  additionalProperties Json?
  deleted              Boolean   @default(false)

  @@unique([raceId, continentId])
}

model SubraceContinent {
  id        String  @id @default(uuid())
  reasoning String  @db.Text
  seeded    Boolean @default(false)

  subraceId            String
  subrace              Subrace   @relation(fields: [subraceId], references: [id])
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  additionalProperties Json?
  deleted              Boolean   @default(false)

  @@unique([subraceId, continentId])
}

model SubclassContinent {
  id        String  @id @default(uuid())
  reasoning String  @db.Text
  seeded    Boolean @default(false)

  subclassId           String
  subclass             Subclass  @relation(fields: [subclassId], references: [id])
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  additionalProperties Json?
  deleted              Boolean   @default(false)

  @@unique([subclassId, continentId])
}

model Language {
  id          String  @id @default(uuid())
  seeded      Boolean @default(false)
  name        String
  description String? @db.Text

  races                Race[]
  continentsPrimary    Continent[] @relation("PrimaryLanguages")
  continentsSecondary  Continent[] @relation("SecondaryLanguages")
  continentsRare       Continent[] @relation("RareLanguages")
  characters           Character[]
  additionalProperties Json?
  deleted              Boolean     @default(false)
}

model Subrace {
  id          String  @id @default(uuid())
  name        String
  description String  @db.Text
  playstyle   String? @db.Text
  seeded      Boolean @default(false)

  ageAdulthoodOverride     Int?
  ageLifespanOverride      Int?
  heightRangeHighOverride  Float?
  heightRangeLowOverride   Float?
  weightRangeHighOverride  Int?
  weightRangeLowOverride   Int?
  skinTonesOverrideAppend  Boolean  @default(false)
  skinTonesOverride        String[]
  skinTextureOverride      String?  @db.Text
  hairColorsOverrideAppend Boolean  @default(false)
  hairColorsOverride       String[]
  hairTextureOverride      String?  @db.Text

  namesOverrideAppend  Boolean   @default(false)
  namesIdOverride      String?
  namesOverride        RaceName? @relation(fields: [namesIdOverride], references: [id])
  additionalProperties Json?
  deleted              Boolean   @default(false)
  raceId               String
  race                 Race      @relation(fields: [raceId], references: [id])

  worlds                  World[]
  continentLocations      SubraceContinent[]
  subclassRecommendations SubraceSubclassRecommendation[]
  deityRecommendations    SubraceDeity[]
  characters              Character[]
}

model ClassRole {
  id                   String   @id @default(uuid())
  name                 String
  seeded               Boolean  @default(false)
  purpose              String?
  keyTraits            String[]
  additionalProperties Json?
  deleted              Boolean  @default(false)
  classes              Class[]
}

model Class {
  id                   String      @id @default(uuid())
  name                 String
  description          String      @db.Text
  roles                ClassRole[]
  playstyle            String?     @db.Text
  seeded               Boolean     @default(false)
  additionalProperties Json?
  deleted              Boolean     @default(false)

  worlds               World[]
  subclasses           Subclass[]
  deityRecommendations ClassDeity[]
  characters           Character[]
  creatorId            String?
  creator              User?             @relation(fields: [creatorId], references: [id])
  collections          ClassCollection[]
}

model ClassCollection {
  id      String  @id @default(uuid())
  name    String
  seeded  Boolean @default(false)
  classes Class[]

  createrId String
  creator   User   @relation("UserCreatedClassCollections", fields: [createrId], references: [id])
  importers User[] @relation("UserImportedClassCollections")

  importedToWorlds World[]
}

model Subclass {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  playstyle            String? @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?
  deleted              Boolean @default(false)

  classId                String
  class                  Class                           @relation(fields: [classId], references: [id])
  worlds                 World[]
  raceRecommendations    RaceSubclassRecommendation[]
  subraceRecommendations SubraceSubclassRecommendation[]
  continentLocations     SubclassContinent[]
  deityRecommendations   SubclassDeity[]
  characters             Character[]
}

model RaceSubclassRecommendation {
  id                   String   @id @default(uuid())
  reasoning            String   @db.Text
  seeded               Boolean  @default(false)
  additionalProperties Json?
  deleted              Boolean  @default(false)
  raceId               String
  race                 Race     @relation(fields: [raceId], references: [id])
  subclassId           String
  subclass             Subclass @relation(fields: [subclassId], references: [id])

  @@unique([raceId, subclassId])
}

model SubraceSubclassRecommendation {
  id                   String   @id @default(uuid())
  reasoning            String   @db.Text
  seeded               Boolean  @default(false)
  additionalProperties Json?
  deleted              Boolean  @default(false)
  subraceId            String
  subrace              Subrace  @relation(fields: [subraceId], references: [id])
  subclassId           String
  subclass             Subclass @relation(fields: [subclassId], references: [id])

  @@unique([subraceId, subclassId])
}

// ============================================================================
// PANTHEON & DEITIES
// ============================================================================

model Pantheon {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  symbol               String?
  seeded               Boolean @default(false)
  additionalProperties Json?
  deleted              Boolean @default(false)
  deities              Deity[]
  worlds               World[]
}

model Deity {
  id                   String         @id @default(uuid())
  name                 String
  title                String?
  symbol               String?
  description          String         @db.Text
  temples              String?        @db.Text
  seeded               Boolean        @default(false)
  additionalProperties Json?
  deleted              Boolean        @default(false)
  pantheonId           String
  pantheon             Pantheon       @relation(fields: [pantheonId], references: [id])
  worlds               World[]
  domains              String[]
  followers            String[]
  holyDays             DeityHolyDay[]
  symbols              String[]
  colors               String[]
  history              DeityHistory[]

  alliesFrom DeityRelationship[] @relation("DeityFrom")
  alliesTo   DeityRelationship[] @relation("DeityTo")

  races       RaceDeity[]
  subraces    SubraceDeity[]
  classes     ClassDeity[]
  subclasses  SubclassDeity[]
  continents  ContinentDeity[]
  characters  Character[]
  collections DeityCollection[]
  creatorId   String?
  creator     User?             @relation(fields: [creatorId], references: [id])
}

model DeityCollection {
  id               String  @id @default(uuid())
  name             String
  seeded           Boolean @default(false)
  deities          Deity[]
  creatorId        String?
  creator          User?   @relation("UserCreatedDeityCollections", fields: [creatorId], references: [id])
  importers        User[]  @relation("UserImportedDeityCollections")
  importedToWorlds World[]
}

model DeityHolyDay {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?
  deleted              Boolean @default(false)
  date                 String?

  deityId String
  deity   Deity  @relation(fields: [deityId], references: [id])
}

model DeityHistory {
  id                   String           @id @default(uuid())
  eraId                String
  era                  HistoricalPeriod @relation(fields: [eraId], references: [id])
  description          String?          @db.Text
  seeded               Boolean          @default(false)
  additionalProperties Json?
  deleted              Boolean          @default(false)
  deityId              String
  deity                Deity            @relation(fields: [deityId], references: [id])
}

enum DeityRelationshipCategory {
  ALLY
  CONFLICT
  FAMILIAL
}

model DeityRelationship {
  id                   String                    @id @default(uuid())
  type                 DeityRelationshipCategory
  reasoning            String?                   @db.Text
  seeded               Boolean                   @default(false)
  additionalProperties Json?
  deleted              Boolean                   @default(false)
  deityId              String
  deity                Deity                     @relation("DeityFrom", fields: [deityId], references: [id])
  relatedDeityId       String
  relatedDeity         Deity                     @relation("DeityTo", fields: [relatedDeityId], references: [id])
}

enum DeityRecommendationType {
  PRIMARY
  SECONDARY
}

model RaceDeity {
  id           String                  @id @default(uuid())
  reasoning    String?                 @db.Text
  relationType DeityRecommendationType
  seeded       Boolean                 @default(false)

  raceId               String
  race                 Race    @relation(fields: [raceId], references: [id])
  deityId              String
  deity                Deity   @relation(fields: [deityId], references: [id])
  additionalProperties Json?
  deleted              Boolean @default(false)

  @@unique([raceId, deityId])
}

model SubraceDeity {
  id           String                  @id @default(uuid())
  reasoning    String?                 @db.Text
  relationType DeityRecommendationType
  seeded       Boolean                 @default(false)

  subraceId            String
  subrace              Subrace @relation(fields: [subraceId], references: [id])
  deityId              String
  deity                Deity   @relation(fields: [deityId], references: [id])
  additionalProperties Json?
  deleted              Boolean @default(false)

  @@unique([subraceId, deityId])
}

model ClassDeity {
  id           String                  @id @default(uuid())
  reasoning    String?                 @db.Text
  relationType DeityRecommendationType
  seeded       Boolean                 @default(false)

  classId              String
  class                Class   @relation(fields: [classId], references: [id])
  deityId              String
  deity                Deity   @relation(fields: [deityId], references: [id])
  additionalProperties Json?
  deleted              Boolean @default(false)

  @@unique([classId, deityId])
}

model SubclassDeity {
  id           String                  @id @default(uuid())
  reasoning    String?                 @db.Text
  relationType DeityRecommendationType
  seeded       Boolean                 @default(false)

  subclassId           String
  subclass             Subclass @relation(fields: [subclassId], references: [id])
  deityId              String
  deity                Deity    @relation(fields: [deityId], references: [id])
  additionalProperties Json?
  deleted              Boolean  @default(false)

  @@unique([subclassId, deityId])
}

model ContinentDeity {
  id           String                  @id @default(uuid())
  reasoning    String?                 @db.Text
  relationType DeityRecommendationType
  seeded       Boolean                 @default(false)

  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])
  deityId              String
  deity                Deity     @relation(fields: [deityId], references: [id])
  additionalProperties Json?
  deleted              Boolean   @default(false)

  @@unique([continentId, deityId])
}

// ============================================================================
// CHARACTERS
// ============================================================================

model Season {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  seeded               Boolean @default(false)
  additionalProperties Json?
  deleted              Boolean @default(false)
  order                Int     @unique @default(autoincrement())
  months               Month[]
  worlds               World[]
}

model Month {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  seeded               Boolean @default(false)
  daysInMonth          Int
  order                Int     @unique @default(autoincrement())
  additionalProperties Json?
  deleted              Boolean @default(false)
  seasonId             String
  season               Season  @relation(fields: [seasonId], references: [id])

  worlds World[]
}

model WeekDay {
  id                   String  @id @default(uuid())
  name                 String
  seeded               Boolean @default(false)
  order                Int     @unique @default(autoincrement())
  additionalProperties Json?
  deleted              Boolean @default(false)
  worlds               World[]
}

model Character {
  id                    String   @id @default(uuid())
  seeded                Boolean  @default(false)
  name                  String
  preNominalHonorifics  String[]
  postNominalHonorifics String[]
  imagePath             String?
  additionalProperties  Json?
  deleted               Boolean  @default(false)
  // Demographics
  gender                String?
  age                   Int?
  birthDate             String?

  // Physical & Personality
  appearance    String? @db.Text
  personality   String? @db.Text
  gearLoadout   String? @db.Text
  keyAttributes String? @db.Text
  ideals        String? @db.Text
  bonds         String? @db.Text
  flaws         String? @db.Text
  backstory     String? @db.Text
  powers        Power[]

  // Languages
  languages Language[]

  // Relations to Core Data
  userId String?
  user   User?   @relation(fields: [userId], references: [id])

  raceId    String?
  race      Race?    @relation(fields: [raceId], references: [id])
  subraceId String?
  subrace   Subrace? @relation(fields: [subraceId], references: [id])

  classId    String?
  class      Class?    @relation(fields: [classId], references: [id])
  subclassId String?
  subclass   Subclass? @relation(fields: [subclassId], references: [id])

  deityId        String?
  deity          Deity?  @relation(fields: [deityId], references: [id])
  deityReasoning String? @db.Text

  fromContinentId String?
  fromContinent   Continent? @relation(fields: [fromContinentId], references: [id])
  fromTownId      String?
  fromTown        Town?      @relation("homeTown", fields: [fromTownId], references: [id])
  livesInTownId   String?
  livesInTown     Town?      @relation("LivesInTown", fields: [livesInTownId], references: [id])

  familyGenerationId String?
  familyGeneration   FamilyGeneration? @relation(fields: [familyGenerationId], references: [id])

  worlds         World[]
  creatureSizeId String?
  creatureSize   CreatureSize? @relation(fields: [creatureSizeId], references: [id])
  creatureTypeId String?
  creatureType   CreatureType? @relation(fields: [creatureTypeId], references: [id])

  // Character Role Links
  factionMemberships   FactionMember[]
  factionStaffings     FactionStaff[]
  questAuthor          Quest[]
  continentRuler       CharacterContinentRuler?
  kingdomRuler         CharacterKingdomRuler?
  townJobs             CharacterProfession[]
  factionRelationships CharacterFactionRelationship[]
  relationshipsFrom    CharacterRelationship[]        @relation("CharacterFrom")
  relationshipsTo      CharacterRelationship[]        @relation("CharacterTo")

  // Quest & Gameplay
  quests QuestMemberReport[]

  // Graveyard
  graveyardEntry GraveyardEntry?
}

model FamilyGeneration {
  id                   String     @id @default(uuid())
  generationNumber     Int
  additionalProperties Json?
  deleted              Boolean    @default(false)
  seeded               Boolean    @default(false)
  familyTreeId         String
  familyTree           FamilyTree @relation(fields: [familyTreeId], references: [id])

  characters Character[]

  @@unique([familyTreeId, generationNumber])
}

model FamilyTree {
  id                   String                  @id @default(uuid())
  name                 String?
  description          String?                 @db.Text
  additionalProperties Json?
  deleted              Boolean                 @default(false)
  seeded               Boolean                 @default(false)
  generations          FamilyGeneration[]
  memberRelationships  CharacterRelationship[]
  worlds               World[]
}

// Character Role Links

model CharacterKingdomRuler {
  id                   String    @id @default(uuid())
  title                String?
  rulingStyle          String?   @db.Text
  startedRulingDate    String?
  additionalProperties Json?
  deleted              Boolean   @default(false)
  seeded               Boolean   @default(false)
  characterId          String    @unique
  character            Character @relation(fields: [characterId], references: [id])
  kingdomId            String    @unique
  kingdom              Kingdom   @relation(fields: [kingdomId], references: [id])
}

model CharacterContinentRuler {
  id                   String    @id @default(uuid())
  seeded               Boolean   @default(false)
  title                String?
  rulingStyle          String?   @db.Text
  startedRulingDate    String?
  additionalProperties Json?
  deleted              Boolean   @default(false)
  characterId          String    @unique
  character            Character @relation(fields: [characterId], references: [id])
  continentId          String    @unique
  continent            Continent @relation(fields: [continentId], references: [id])
}

// Character Relationships
model CharacterRelationship {
  id                   String    @id @default(uuid())
  description          String?   @db.Text
  additionalProperties Json?
  deleted              Boolean   @default(false)
  seeded               Boolean   @default(false)
  fromCharacterType    String // e.g., "parent", "sibling", "friend", "rival", "spouse", etc.
  fromCharacterId      String
  fromCharacter        Character @relation("CharacterFrom", fields: [fromCharacterId], references: [id])
  toCharacterType      String // e.g., "parent", "sibling", "friend", "rival", "spouse", etc.
  toCharacterId        String
  toCharacter          Character @relation("CharacterTo", fields: [toCharacterId], references: [id])

  relationshipType String
  familyTreeId     String?
  familyTree       FamilyTree? @relation(fields: [familyTreeId], references: [id])
}

// Graveyard
model Graveyard {
  id                   String        @id @default(uuid())
  name                 String?
  description          String?       @db.Text
  additionalProperties Json?
  deleted              Boolean       @default(false)
  towns                Town[]
  factionBases         FactionBase[]

  entries GraveyardEntry[]
}

model GraveyardEntry {
  id                   String  @id @default(uuid())
  causeOfDeath         String? @db.Text
  headstoneInscription String? @db.Text

  deathDate            String?
  additionalProperties Json?
  deleted              Boolean   @default(false)
  characterId          String    @unique
  character            Character @relation(fields: [characterId], references: [id])
  graveyardId          String
  graveyard            Graveyard @relation(fields: [graveyardId], references: [id])
}

// ============================================================================
// QUESTS
// ============================================================================

model Quest {
  id                   String       @id @default(uuid())
  name                 String
  description          String       @db.Text
  rankId               String?
  rank                 FactionRank? @relation(fields: [rankId], references: [id])
  commissionedById     String?
  commissionedBy       Character?   @relation(fields: [commissionedById], references: [id])
  dateCommissioned     String?
  dateDue              String?
  dateCompleted        String?
  location             String?
  outcome              String?
  extraNotes           String?      @db.Text
  seeded               Boolean      @default(false)
  additionalProperties Json?
  deleted              Boolean      @default(false)
  imagePath            String?
  factionId            String
  faction              Faction      @relation(fields: [factionId], references: [id])
  townId               String?
  town                 Town?        @relation(fields: [townId], references: [id])
  regionId             String?
  region               Region?      @relation(fields: [regionId], references: [id])
  continentId          String?
  continent            Continent?   @relation(fields: [continentId], references: [id])

  legendaryCreatues LegendaryCreature[]
  participants      QuestParticipant[]
  enemies           QuestEnemy[]
  awards            QuestAward[]
  loot              QuestLoot[]
  memberReports     QuestMemberReport[]
  fallenMembers     QuestFallenMember[]
}

model QuestParticipant {
  id                   String        @id @default(uuid())
  rankAtTimeId         String
  rankAtTime           FactionRank   @relation(fields: [rankAtTimeId], references: [id])
  role                 String?
  additionalProperties Json?
  deleted              Boolean       @default(false)
  questId              String
  quest                Quest         @relation(fields: [questId], references: [id])
  memberId             String
  member               FactionMember @relation(fields: [memberId], references: [id])

  @@unique([questId, memberId])
}

model QuestEnemy {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  quantity             Int?
  additionalProperties Json?
  deleted              Boolean @default(false)
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id])
}

model QuestAward {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  additionalProperties Json?
  deleted              Boolean @default(false)
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id])
}

model QuestLoot {
  id                   String  @id @default(uuid())
  name                 String
  description          String? @db.Text
  quantity             Int?
  additionalProperties Json?
  deleted              Boolean @default(false)
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id])
}

model QuestMemberReport {
  id                   String     @id @default(uuid())
  report               String     @db.Text
  memberName           String?
  additionalProperties Json?
  deleted              Boolean    @default(false)
  questId              String
  quest                Quest      @relation(fields: [questId], references: [id])
  characterId          String?
  character            Character? @relation(fields: [characterId], references: [id])
}

model QuestFallenMember {
  id                   String  @id @default(uuid())
  memberName           String
  cause                String? @db.Text
  additionalProperties Json?
  deleted              Boolean @default(false)
  questId              String
  quest                Quest   @relation(fields: [questId], references: [id])
}

// ============================================================================
// CHARACTERS & PROFESSIONS
// ============================================================================

model CharacterProfession {
  id                     String                           @id @default(uuid())
  name                   String
  description            String?                          @db.Text
  category               String?
  seeded                 Boolean                          @default(false)
  additionalProperties   Json?
  deleted                Boolean                          @default(false)
  restrictedToContinents ProfessionContinentRestriction[]
  restrictedToTowns      ProfessionTownRestriction[]
  towns                  Town[]
  shops                  Shop[]
  characters             Character[]
}

model ProfessionContinentRestriction {
  id                   String              @id @default(uuid())
  additionalProperties Json?
  deleted              Boolean             @default(false)
  professionId         String
  profession           CharacterProfession @relation(fields: [professionId], references: [id])
  continentId          String
  continent            Continent           @relation(fields: [continentId], references: [id])

  @@unique([professionId, continentId])
}

model ProfessionTownRestriction {
  id                   String              @id @default(uuid())
  additionalProperties Json?
  deleted              Boolean             @default(false)
  professionId         String
  profession           CharacterProfession @relation(fields: [professionId], references: [id])
  townId               String
  town                 Town                @relation(fields: [townId], references: [id])

  @@unique([professionId, townId])
}

// ============================================================================
// FACTIONS
// ============================================================================

model Faction {
  id                   String  @id @default(uuid())
  name                 String
  description          String  @db.Text
  mainPurpose          String  @db.Text
  emblemPath           String?
  emblemDescription    String? @db.Text
  foundedDate          String?
  seeded               Boolean @default(false)
  additionalProperties Json?
  deleted              Boolean @default(false)
  motto                String?
  philosophy           String? @db.Text

  worlds              World[]
  continentPresence   FactionContinentPresence[]
  regionRelationships FactionRegionRelationship[]
  townRelationships   FactionTownRelationship[]
  relationshipsFrom   FactionRelationship[]       @relation("FactionFrom")
  relationshipsTo     FactionRelationship[]       @relation("FactionTo")
  historicEvents      FactionHistoricEvent[]

  quests Quest[]

  factionBases           FactionBase[]
  factionRanks           FactionRank[]
  characterMembers       FactionMember[]
  characterStaff         FactionStaff[]
  characterRelationships CharacterFactionRelationship[]

  factionMasterUsers User[] @relation("FactionMasters")
  factionMemberUsers User[] @relation("FactionMembers")
}

model FactionRank {
  id                   String             @id @default(uuid())
  seeded               Boolean            @default(false)
  name                 String
  description          String?            @db.Text
  color                String?
  imagePath            String?
  levelLow             Int
  levelHigh            Int
  additionalProperties Json?
  deleted              Boolean            @default(false)
  faction              Faction[]
  factionStaff         FactionStaff[]
  factionMembers       FactionMember[]
  quests               Quest[]
  questParticipants    QuestParticipant[]
}

enum MemberStatus {
  ACTIVE
  INACTIVE
  DECEASED
  RETIRED
  MISSING
  HIATUS
  EXPELLED
  ABROAD
}

model FactionMember {
  id                   String       @id @default(uuid())
  joinedDate           String?
  isSecretMember       Boolean      @default(false)
  rankId               String
  rank                 FactionRank  @relation(fields: [rankId], references: [id])
  status               MemberStatus @default(ACTIVE)
  specialization       String?
  seeded               Boolean      @default(false)
  additionalProperties Json?
  deleted              Boolean      @default(false)
  characterId          String
  character            Character    @relation(fields: [characterId], references: [id])
  factionId            String
  faction              Faction      @relation(fields: [factionId], references: [id])

  tags                String[]
  achievements        String[]
  questParticipations QuestParticipant[]
  factionBases        FactionBase[]
}

model FactionStaff {
  id                   String        @id @default(uuid())
  rankId               String?
  rank                 FactionRank?  @relation(fields: [rankId], references: [id])
  positionTitle        String?
  responsibilities     String?       @db.Text
  seeded               Boolean       @default(false)
  additionalProperties Json?
  deleted              Boolean       @default(false)
  factionBases         FactionBase[]
  characterId          String
  character            Character     @relation(fields: [characterId], references: [id])
  factionId            String
  faction              Faction       @relation(fields: [factionId], references: [id])
}

model FactionContinentPresence {
  id                   String    @id @default(uuid())
  influenceLevel       String? // Example: "MINOR", "MODERATE", "MAJOR", "DOMINANT", "HIDDEN"
  description          String?   @db.Text
  seeded               Boolean   @default(false)
  activities           String[]
  additionalProperties Json?
  deleted              Boolean   @default(false)
  factionId            String
  faction              Faction   @relation(fields: [factionId], references: [id])
  continentId          String
  continent            Continent @relation(fields: [continentId], references: [id])

  @@unique([factionId, continentId])
}

model FactionRegionRelationship {
  id                   String   @id @default(uuid())
  description          String?  @db.Text
  seeded               Boolean  @default(false)
  activites            String[]
  relationshipType     String // e.g., "ALLIED", "HOSTILE", "NEUTRAL", "CONTROLS", etc.
  additionalProperties Json?
  deleted              Boolean  @default(false)
  factionId            String
  faction              Faction  @relation(fields: [factionId], references: [id])
  regionId             String
  region               Region   @relation(fields: [regionId], references: [id])

  @@unique([factionId, regionId])
}

model FactionBase {
  id                   String     @id @default(uuid())
  name                 String
  description          String     @db.Text
  imagePath            String?
  services             String[]
  isSecret             Boolean    @default(false)
  seeded               Boolean    @default(false)
  additionalProperties Json?
  deleted              Boolean    @default(false)
  factionId            String
  faction              Faction    @relation(fields: [factionId], references: [id])
  continentId          String?
  continent            Continent? @relation(fields: [continentId], references: [id])
  regionId             String?
  region               Region?    @relation(fields: [regionId], references: [id])
  townId               String?
  town                 Town?      @relation(fields: [townId], references: [id])
  graveyardId          String?
  graveyard            Graveyard? @relation(fields: [graveyardId], references: [id])

  members FactionMember[]
  staff   FactionStaff[]

  @@unique([factionId, townId, name])
}

model FactionRelationship {
  id                   String  @id @default(uuid())
  description          String? @db.Text
  since                Int?
  additionalProperties Json?
  deleted              Boolean @default(false)
  fromFactionId        String
  fromFaction          Faction @relation("FactionFrom", fields: [fromFactionId], references: [id])
  toFactionId          String
  toFaction            Faction @relation("FactionTo", fields: [toFactionId], references: [id])

  relationshipType String // e.g., "ALLIED", "HOSTILE", "NEUTRAL", "TRADE_PARTNER", "RIVAL", "PROTECTOR", "SUBSERVIENT", "ENEMY"

  @@unique([fromFactionId, toFactionId])
}

// Character-Faction Relationships
model CharacterFactionRelationship {
  id                   String    @id @default(uuid())
  type                 String // e.g., "ALLY", "ENEMY", "SUPPORTER", "TRADE_PARTNER"
  notes                String?   @db.Text
  additionalProperties Json?
  deleted              Boolean   @default(false)
  characterId          String
  character            Character @relation(fields: [characterId], references: [id])
  factionId            String
  faction              Faction   @relation(fields: [factionId], references: [id])

  @@unique([characterId, factionId, type])
}

// Faction-Town Relationships
model FactionTownRelationship {
  id                   String   @id @default(uuid())
  description          String?  @db.Text
  activites            String[]
  seeded               Boolean  @default(false)
  relationshipType     String // e.g., "ALLIED", "HOSTILE", "NEUTRAL", "CONTROLS", etc.
  additionalProperties Json?
  deleted              Boolean  @default(false)
  factionId            String
  faction              Faction  @relation(fields: [factionId], references: [id])
  townId               String
  town                 Town     @relation(fields: [townId], references: [id])

  @@unique([factionId, townId])
}

// Faction Historic Events
model FactionHistoricEvent {
  id                   String  @id @default(uuid())
  seeded               Boolean @default(false)
  name                 String
  description          String  @db.Text
  eventType            String // e.g., "FOUNDING", "LEADERSHIP_CHANGE", "ENEMY_DECLARED", "ALLY_FORMED", "ACHIEVEMENT", "MILESTONE"
  additionalProperties Json?
  deleted              Boolean @default(false)
  eventDate            String?
  eventDateRange       String?

  factionId String
  faction   Faction @relation(fields: [factionId], references: [id])

  @@index([factionId])
}

// ============================================================================
// MONSTER SLAYERS GUIDE (BESTIARY)
// ============================================================================

enum ContinentCreatureRelation {
  PRIMARY
  SECONDARY
  RARE
}

model ContinentCreatureType {
  id                   String                    @id @default(uuid())
  seeded               Boolean                   @default(false)
  relation             ContinentCreatureRelation
  reasoning            String?                   @db.Text
  additionalProperties Json?
  deleted              Boolean                   @default(false)
  continentId          String
  continent            Continent                 @relation(fields: [continentId], references: [id])
  creatureTypeId       String
  creatureType         CreatureType              @relation(fields: [creatureTypeId], references: [id])

  @@unique([continentId, creatureTypeId])
}

model RegionCreatureType {
  id                   String       @id @default(uuid())
  seeded               Boolean      @default(false)
  reasoning            String?      @db.Text
  additionalProperties Json?
  deleted              Boolean      @default(false)
  regionId             String
  region               Region       @relation(fields: [regionId], references: [id])
  creatureTypeId       String
  creatureType         CreatureType @relation(fields: [creatureTypeId], references: [id])

  @@unique([regionId, creatureTypeId])
}

model CreatureType {
  id                   String                  @id @default(uuid())
  name                 String
  description          String                  @db.Text
  habits               String?                 @db.Text
  tactics              String?                 @db.Text
  weaknesses           String?                 @db.Text
  seeded               Boolean                 @default(false)
  additionalProperties Json?
  deleted              Boolean                 @default(false)
  commonSizes          CreatureSize[]          @relation("CreatureTypeCommonSizes")
  worlds               World[]
  continents           ContinentCreatureType[]
  regions              RegionCreatureType[]
  characters           Character[]
  creatures            Creature[]
  legendaryCreatures   LegendaryCreature[]
}

model CreatureSize {
  id                   String              @id @default(uuid())
  seeded               Boolean             @default(false)
  name                 String
  occupiedSpace        String
  heightRange          String
  weightRange          String
  description          String?             @db.Text
  additionalProperties Json?
  deleted              Boolean             @default(false)
  creatureTypes        CreatureType[]      @relation("CreatureTypeCommonSizes")
  races                Race[]
  characters           Character[]
  creatures            Creature[]
  legendaryCreatures   LegendaryCreature[]
}

model Creature {
  id                   String              @id @default(uuid())
  name                 String
  description          String              @db.Text
  packSize             Int?
  habitat              String?
  behavior             String?             @db.Text
  diet                 String?
  averageSize          String?
  averageWeight        String?
  creatureSizeId       String?
  creatureSize         CreatureSize?       @relation(fields: [creatureSizeId], references: [id])
  lifespan             String?
  dangerLevel          Int?
  seeded               Boolean             @default(false)
  additionalProperties Json?
  deleted              Boolean             @default(false)
  creatureTypeId       String
  creatureType         CreatureType        @relation(fields: [creatureTypeId], references: [id])
  legendaryCreatures   LegendaryCreature[]
  worlds               World[]
  continents           Continent[]
  regions              Region[]
  powers               Power[]
  predatorLinks        CreatureFoodChain[] @relation("predatorLinks")
  preyLinks            CreatureFoodChain[] @relation("preyLinks")
}

model CreatureFoodChain {
  id         String @id @default(uuid())
  predatorId String
  preyId     String

  predator Creature @relation("predatorLinks", fields: [predatorId], references: [id], map: "creaturefoodchain_predator_fkey")
  prey     Creature @relation("preyLinks", fields: [preyId], references: [id], map: "creaturefoodchain_prey_fkey")

  @@unique([predatorId, preyId])
}

enum LegendaryCreatureThreatLevel {
  CITY
  REGIONAL
  CONTINENTAL
  GLOBAL
  INTERWORLD
}

model LegendaryCreature {
  id                   String                       @id @default(uuid())
  name                 String
  description          String                       @db.Text
  threatLevel          LegendaryCreatureThreatLevel
  questPotential       String?                      @db.Text
  isPast               Boolean                      @default(false)
  defeatedBy           String?
  defeatedByTitle      String?
  defeatStory          String?                      @db.Text
  legacy               String?                      @db.Text
  seeded               Boolean                      @default(false)
  powers               Power[]
  additionalProperties Json?
  deleted              Boolean                      @default(false)
  creatureSizeId       String
  creatureSize         CreatureSize                 @relation(fields: [creatureSizeId], references: [id])

  creatureTypeId String
  creatureType   CreatureType @relation(fields: [creatureTypeId], references: [id])

  creatureId String?
  creature   Creature? @relation(fields: [creatureId], references: [id])

  continentId String
  continent   Continent @relation(fields: [continentId], references: [id])

  quests Quest[]
  worlds World[]
}
